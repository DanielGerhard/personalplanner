(()=>{"use strict";function e(e,t){let n;return function(o){clearTimeout(n),n=setTimeout((function(){e(o)}),t)}}function t({type:e="text",value:t=null,name:n=null,key:o=null,field:l=null,placeholder:a=null,elementClass:i=null,onChange:r=null}){let c=document.createElement("input");return c.setAttribute("input-editavel",""),e&&(c.type=e),n&&(c.name=n),t&&(c.value=t),o&&c.setAttribute("key",o),l&&c.setAttribute("field",l),a&&(c.placeholder=a),r&&c.setAttribute("onchange",r),i&&c.classList.add(i),c}function n(n,a){let i=document.querySelector(n).querySelector("tbody");i.innerHTML="",a.forEach((e=>{const n=document.createElement("tr"),o=document.createElement("td"),l=t({type:"text",value:e.descricao,field:"descricao",key:e.id,elementClass:"input-editavel"});o.appendChild(l),n.appendChild(o);const a=document.createElement("td"),r=document.createElement("label");r.textContent="R$",r.classList.add("label-input-editavel");const c=t({type:"number",value:e.valor,field:"valor",key:e.id,elementClass:"input-editavel money"});a.appendChild(r),a.appendChild(c),n.appendChild(a);const u=document.createElement("td");u.appendChild(function(e){let t=document.querySelector("[default-delete-button]").content.cloneNode(!0);if(t)return t.querySelector("button").value=e,t}(e.id)),n.appendChild(u),i.appendChild(n)})),function(){let t=document.querySelectorAll("[default-delete-button-ce]");t.length>0&&t.forEach((function(e){e.addEventListener("click",(function(t){var n,a;t.preventDefault(),a={id:n=e.value},fetch("/api/lista-de-compras/ListaDeCompras/"+n+"/",{method:"DELETE",headers:{"X-CSRFToken":o,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){if(!e.ok)throw new Error("Erro ao Deletar o item.")})).then((function(e){l()})).catch((function(e){console.error("Erro:",e)}))}))})),document.querySelectorAll("[input-editavel]").forEach((function(t){t.addEventListener("input",e((function(n){!function({itemId:t=null,valorItem:n=null,campoItem:a=null}){var i={id:t,[a]:n};fetch("/api/lista-de-compras/ListaDeCompras/"+t+"/",{method:"PATCH",headers:{"X-CSRFToken":o,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){if(e.ok)return e.json();throw new Error("Erro ao atualizar o item.")})).then((function(t){e((function(e){l()}),2e3)})).catch((function(e){console.error("Erro:",e)}))}({itemId:t.getAttribute("key"),valorItem:t.value,campoItem:t.getAttribute("field")})}),800))}))}()}let o;function l(){fetch("/api/lista-de-compras/ListaDeCompras/?format=json").then((e=>e.json())).then((e=>{n("[js-tabela]",e)})).catch((e=>{console.error(e)}))}o=document.querySelector("[name=csrfmiddlewaretoken]").value,l(),function(){const e=document.querySelector("[button-mais]");e&&e.addEventListener("click",(function(e){e.preventDefault(),fetch("/api/lista-de-compras/ListaDeCompras/",{method:"POST",headers:{"X-CSRFToken":o,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(void(new Date).toISOString().slice(0,23).padEnd(26,"0"))}).then((e=>{201===e.status?(console.log("Item criado com sucesso!"),l()):console.error("Erro ao criar o item:",e.status)})).catch((e=>{console.error("Erro na requisição:",e)}))}))}()})();